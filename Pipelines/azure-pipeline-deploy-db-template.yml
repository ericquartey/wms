
steps:

- script: 'dotnet ef database update --verbose --context BuildDatabaseContext'
  workingDirectory: Common/EF
  failOnStderr: true
  displayName: 'dotnet ef database update'
  continueOnError: true
  env:
    NETCORE_ENVIRONMENT: CloudBuild
    buildNumber: '$(Build.BuildId)'

- task: SqlAzureDacpacDeployment@1
  displayName: 'Azure SQL Publish'
  inputs:
    TaskNameSelector: SqlTask
    SqlFile: Common/EF/Seeds/Dev.Minimal.sql
  enabled: false

- script: 'dotnet ef database drop --verbose --context BuildDatabaseContext'
  workingDirectory: Common/EF
  failOnStderr: true
  displayName: 'dotnet ef database drop'
  continueOnError: true
  env:
    NETCORE_ENVIRONMENT: CloudBuild
    buildNumber: '$(Build.BuildId)'
