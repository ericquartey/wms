<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:dxe="http://schemas.devexpress.com/winfx/2008/xaml/editors">

    <ControlTemplate x:Key="ValidationErrorTemplateStyle">
        <StackPanel Orientation="Horizontal">
            <Grid>
                <AdornedElementPlaceholder x:Name="adorner"
                                           MaxHeight="44"
                                           Margin="0,-22,0,0"
                                           HorizontalAlignment="Left"
                                           VerticalAlignment="Top" />
                <Border HorizontalAlignment="Stretch"
                        VerticalAlignment="Stretch"
                        BorderBrush="{DynamicResource ErrorMessageBackgroundColor}"
                        BorderThickness="1"
                        CornerRadius="0.1">
                    <Grid>
                        <Polygon x:Name="toolTipCorner"
                                 Margin="-1"
                                 HorizontalAlignment="Right"
                                 VerticalAlignment="Top"
                                 Fill="{DynamicResource ErrorMessageBackgroundColor}"
                                 Grid.ZIndex="2"
                                 IsHitTestVisible="True"
                                 Points="9,9 9,0 0,0" />
                        <Polyline Margin="-1"
                                  HorizontalAlignment="Right"
                                  VerticalAlignment="Top"
                                  Grid.ZIndex="3"
                                  IsHitTestVisible="True"
                                  Points="10,10 0,0"
                                  Stroke="White"
                                  StrokeEndLineCap="Round"
                                  StrokeStartLineCap="Round"
                                  StrokeThickness="1.5" />
                    </Grid>
                </Border>
            </Grid>
            <dxe:FlyoutControl x:Name="errorPopup"
                               PlacementTarget="{Binding ElementName=toolTipCorner}"
                               IsOpen="True"
                               StaysOpen="True"
                               BorderThickness="0"
                               Padding="0"
                               Background="Transparent">
                <dxe:FlyoutControl.Settings>
                    <dxe:FlyoutSettings Placement="Right" ShowIndicator="False" />
                </dxe:FlyoutControl.Settings>
                <Border x:Name="errorBorder"
                        MaxWidth="500"
                        MaxHeight="25"
                        Margin="0,0,8,8"
                        Background="{DynamicResource ErrorMessageBackgroundColor}"
                        CornerRadius="1.5"
                        IsHitTestVisible="False"
                        Opacity="0">
                    <Border.Effect>
                        <DropShadowEffect BlurRadius="10"
                                          Direction="315"
                                          Opacity="0.8"
                                          ShadowDepth="5"
                                          Color="Black" />
                    </Border.Effect>
                    <TextBlock Margin="8,3,8,3"
                               Foreground="{DynamicResource ErrorMessageTextToolTipForegroundColor}"
                               Text="{Binding Path=AdornedElement.(Validation.Errors)/ErrorContent, ElementName=adorner}"
                               TextWrapping="Wrap" />
                </Border>
            </dxe:FlyoutControl>

        </StackPanel>
        <ControlTemplate.Triggers>
            <Trigger Property="Visibility" Value="Visible">
                <Trigger.EnterActions>
                    <BeginStoryboard x:Name="fadeInStoryboard">
                        <Storyboard>
                            <DoubleAnimation Storyboard.TargetName="errorBorder"
                                             Storyboard.TargetProperty="Opacity"
                                             To="1"
                                             Duration="00:00:00.15" />
                        </Storyboard>
                    </BeginStoryboard>
                </Trigger.EnterActions>

                <Trigger.ExitActions>
                    <StopStoryboard BeginStoryboardName="fadeInStoryboard" />
                    <BeginStoryboard x:Name="fadeOutStoryBoard">
                        <Storyboard>
                            <DoubleAnimation Storyboard.TargetName="errorBorder"
                                             Storyboard.TargetProperty="Opacity"
                                             To="0"
                                             Duration="00:00:00.15" />
                        </Storyboard>
                    </BeginStoryboard>
                </Trigger.ExitActions>
            </Trigger>
        </ControlTemplate.Triggers>
    </ControlTemplate>

</ResourceDictionary>
