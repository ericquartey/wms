<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:ctrls="clr-namespace:Ferretto.Common.Controls;assembly=Ferretto.Common.Controls"
                    xmlns:dx="http://schemas.devexpress.com/winfx/2008/xaml/core"
                    xmlns:dxcn="http://schemas.devexpress.com/winfx/2008/xaml/core/internal"
                    xmlns:dxcop="clr-namespace:DevExpress.Xpf.Controls.Primitives;assembly=DevExpress.Xpf.Controls.v18.1"
                    xmlns:dxdst="http://schemas.devexpress.com/winfx/2008/xaml/core/themekeys"
                    xmlns:dxe="http://schemas.devexpress.com/winfx/2008/xaml/editors"
                    xmlns:dxei="http://schemas.devexpress.com/winfx/2008/xaml/editors/internal"
                    xmlns:dxnav="http://schemas.devexpress.com/winfx/2008/xaml/navigation"
                    xmlns:dxnavi="clr-namespace:DevExpress.Xpf.Navigation.Internal;assembly=DevExpress.Xpf.Controls.v18.1"
                    xmlns:dxwuit="http://schemas.devexpress.com/winfx/2008/xaml/windowsui/themekeys">

    <dx:BoolToVisibilityConverter x:Key="boolToVisibilityConverter" />

    <ctrls:FlyoutContentTemplateSelector x:Key="FlyoutContentTemplateSelector" />

    <Style TargetType="dxcop:FlyoutAdornerControl">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="dxcop:FlyoutAdornerControl">
                    <dxcop:FlyoutAdornerContentControl x:Name="PART_Popup"
                                                       Focusable="False">
                        <dxcop:FlyoutAdornerContentControl.Resources>
                            <dxei:IndicatorDirectionToVisibilityConverter x:Key="IndicatorDirectionToVisibilityConverter" />
                        </dxcop:FlyoutAdornerContentControl.Resources>
                        <Canvas x:Name="PART_Canvas">
                            <ContentControl x:Name="PART_cc"
                                            Focusable="False">
                                <Grid x:Name="PART_RenderGrid"
                                      Margin="0,0,0,0"
                                      FlowDirection="LeftToRight">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="*" />
                                        <RowDefinition Height="Auto" />
                                    </Grid.RowDefinitions>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>
                                    <Border x:Name="PART_Container"
                                            Grid.Row="1"
                                            Grid.Column="1"
                                            HorizontalAlignment="Stretch"
                                            Background="{DynamicResource CommonDarkGrey}"
                                            BorderBrush="{TemplateBinding BorderBrush}"
                                            BorderThickness="{TemplateBinding BorderThickness}">
                                        <dxe:FlyoutContainerControl Margin="{TemplateBinding Padding}"
                                                                    Content="{TemplateBinding Content}"
                                                                    ContentTemplate="{TemplateBinding ContentTemplate}"
                                                                    FlowDirection="{TemplateBinding FlowDirection}"
                                                                    Focusable="False"
                                                                    Style="{TemplateBinding ContainerStyle}" />
                                    </Border>
                                    <Grid x:Name="LeftIndicator"
                                          Grid.RowSpan="3"
                                          Grid.Column="0"
                                          Margin="0,4"
                                          VerticalAlignment="Top"
                                          Visibility="{Binding Path=IndicatorDirection, Converter={StaticResource IndicatorDirectionToVisibilityConverter}, ConverterParameter=Left, RelativeSource={RelativeSource TemplatedParent}}">
                                        <Path Width="13"
                                              Height="26"
                                              Data="F1 M 13,0L 0,13L 13,26L 13,0 Z "
                                              Fill="{Binding PlacementTarget.BorderBrush, RelativeSource={RelativeSource TemplatedParent}}"
                                              Stretch="Fill" />
                                        <Path Width="13"
                                              Height="26"
                                              Data="F1 M 13,0L 0,13L 13,26L 13,0 Z "
                                              Fill="{Binding PlacementTarget.BorderBrush, RelativeSource={RelativeSource TemplatedParent}}"
                                              Stretch="Fill" />
                                        <Path Width="13"
                                              Height="26"
                                              Margin="1,0,-1,0"
                                              Data="F1 M 13,0L 0,13L 13,26L 13,0 Z "
                                              Fill="{Binding PlacementTarget.BorderBrush, RelativeSource={RelativeSource TemplatedParent}}"
                                              Stretch="Fill" />
                                    </Grid>
                                    <Grid x:Name="TopIndicator"
                                          Grid.Row="0"
                                          Grid.ColumnSpan="3"
                                          Margin="4,0"
                                          HorizontalAlignment="Left"
                                          Visibility="Collapsed">

                                        <Path Width="26"
                                              Height="13"
                                              Data="F1 M 26,13L 13,0L 1.23978e-005,13L 26,13 Z "
                                              Fill="DarkRed"
                                              Stretch="Fill" />
                                        <Path Width="26"
                                              Height="13"
                                              Data="F1 M 26,13L 13,0L 1.23978e-005,13L 26,13 Z "
                                              Fill="DarkRed"
                                              Stretch="Fill" />
                                        <Path Width="26"
                                              Height="13"
                                              Margin="0,1,0,-1"
                                              Data="F1 M 26,13L 13,0L 1.23978e-005,13L 26,13 Z "
                                              Fill="Red"
                                              Stretch="Fill" />
                                    </Grid>
                                    <Grid x:Name="RightIndicator"
                                          Grid.RowSpan="3"
                                          Grid.Column="2"
                                          Margin="0,4"
                                          VerticalAlignment="Top"
                                          Visibility="{Binding Path=IndicatorDirection, Converter={StaticResource IndicatorDirectionToVisibilityConverter}, ConverterParameter=Right, RelativeSource={RelativeSource TemplatedParent}}">
                                        <Path Width="13"
                                              Height="26"
                                              Data="F1 M 1.90735e-006,26.0001L 13,13.0001L 1.90735e-006,6.10352e-005L 1.90735e-006,26.0001 Z "
                                              Fill="DarkRed"
                                              Stretch="Fill" />
                                        <Path Width="13"
                                              Height="26"
                                              Data="F1 M 1.90735e-006,26.0001L 13,13.0001L 1.90735e-006,6.10352e-005L 1.90735e-006,26.0001 Z "
                                              Fill="DarkRed"
                                              Stretch="Fill" />
                                        <Path Width="13"
                                              Height="26"
                                              Margin="-1,0,1,0"
                                              Data="F1 M 1.90735e-006,26.0001L 13,13.0001L 1.90735e-006,6.10352e-005L 1.90735e-006,26.0001 Z "
                                              Fill="Red"
                                              Stretch="Fill" />
                                    </Grid>
                                    <Grid x:Name="BottomIndicator"
                                          Grid.Row="2"
                                          Grid.ColumnSpan="3"
                                          Margin="4,0"
                                          HorizontalAlignment="Left"
                                          Visibility="{Binding Path=IndicatorDirection, Converter={StaticResource IndicatorDirectionToVisibilityConverter}, ConverterParameter=Bottom, RelativeSource={RelativeSource TemplatedParent}}">
                                        <Path Width="26"
                                              Height="13"
                                              Data="F1 M -1.04904e-005,0L 13,13L 26,0L -1.04904e-005,0 Z "
                                              Fill="DarkRed"
                                              Stretch="Fill" />
                                        <Path Width="26"
                                              Height="13"
                                              Data="F1 M -1.04904e-005,0L 13,13L 26,0L -1.04904e-005,0 Z "
                                              Fill="DarkRed"
                                              Stretch="Fill" />
                                        <Path Width="26"
                                              Height="13"
                                              Margin="0,-1,0,1"
                                              Data="F1 M -1.04904e-005,0L 13,13L 26,0L -1.04904e-005,0 Z "
                                              Fill="Red"
                                              Stretch="Fill" />
                                    </Grid>
                                </Grid>
                            </ContentControl>
                        </Canvas>
                    </dxcop:FlyoutAdornerContentControl>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <ControlTemplate x:Key="TileBarItemArrowControlEmptyTemplate"
                     TargetType="dxnavi:TileBarItemArrowControl">
        <Grid Background="{TemplateBinding Background}">
            <Grid.RowDefinitions>
                <RowDefinition />
                <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>
            <Path x:Name="Glyph"
                  Grid.Column="1"
                  Width="9"
                  Height="5"
                  HorizontalAlignment="Center"
                  VerticalAlignment="Center"
                  Data="F1 M 0,0L 14.002,0L 7,7L 0,0 Z "
                  RenderTransformOrigin="0.5,0.5"
                  Stretch="Fill"
                  Margin="0,0,10,0">
                <Path.Style>
                    <Style TargetType="Path">
                        <Style.Triggers>
                            <MultiDataTrigger>
                                <MultiDataTrigger.Conditions>
                                    <Condition Binding="{Binding Path=HasChildren}" Value="true" />
                                    <Condition Binding="{Binding Path=IsRootLevel}" Value="true" />
                                </MultiDataTrigger.Conditions>
                                <Setter Property="Fill" Value="{DynamicResource CommonTextLightForeground}" />
                            </MultiDataTrigger>
                            <MultiDataTrigger>
                                <MultiDataTrigger.Conditions>
                                    <Condition Binding="{Binding Path=HasChildren}" Value="true" />
                                    <Condition Binding="{Binding Path=IsRootLevel}" Value="false" />
                                </MultiDataTrigger.Conditions>
                                <Setter Property="Fill" Value="{DynamicResource CommonDarkGrey}" />
                            </MultiDataTrigger>
                        </Style.Triggers>
                    </Style>
                </Path.Style>
                <Path.RenderTransform>
                    <RotateTransform x:Name="ArrowRotateTransform" CenterX="0.5" CenterY="0.5" />
                </Path.RenderTransform>
            </Path>
        </Grid>
    </ControlTemplate>

    <ControlTemplate x:Key="{dxwuit:TileNavPaneElementsThemeKey ResourceKey=TileSelectorItemTemplate,
                                                                ThemeName=Office2016White}"
                     TargetType="dxnav:TileSelectorItem">
        <Grid Width="{DynamicResource MenuTileWidth}"
              Height="{DynamicResource MenuTileHeight}">
            <dx:DXBorder x:Name="Border"
                         Margin="{TemplateBinding ActualSelectionPadding}"
                         BorderBrush="{TemplateBinding BorderBrush}"
                         BorderThickness="{TemplateBinding BorderThickness}"
                         EnableDPICorrection="False">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>
                    <dxnavi:TileButtonControl x:Name="PART_Button"
                                              Padding="{TemplateBinding Padding}"
                                              HorizontalContentAlignment="{TemplateBinding HorizontalContentAlignment}"
                                              VerticalContentAlignment="{TemplateBinding VerticalContentAlignment}"
                                              AllowGlyphTheming="{TemplateBinding AllowGlyphTheming}"
                                              Background="{TemplateBinding CalculatedBackground}"
                                              Content="{TemplateBinding ActualTileContent}"
                                              ContentTemplate="{TemplateBinding ActualTileContentTemplate}"
                                              ContentTemplateSelector="{TemplateBinding ActualTileContentTemplateSelector}"
                                              Foreground="{TemplateBinding CalculatedForeground}"
                                              Glyph="{TemplateBinding TileGlyph}"
                                              HorizontalGlyphAlignment="{TemplateBinding HorizontalTileGlyphAlignment}"
                                              VerticalGlyphAlignment="{TemplateBinding VerticalTileGlyphAlignment}" />
                    <dxnavi:TileBarItemArrowControl x:Name="PART_ArrowButton"
                                                    Grid.Column="0"
                                                    Margin="0,0,0,0"
                                                    HorizontalAlignment="Stretch"
                                                    HorizontalContentAlignment="{TemplateBinding HorizontalContentAlignment}"
                                                    VerticalContentAlignment="{TemplateBinding VerticalContentAlignment}"
                                                    Background="Transparent"
                                                    BorderBrush="Transparent"
                                                    BorderThickness="0"
                                                    IsChecked="{TemplateBinding IsChecked}"
                                                    Template="{StaticResource TileBarItemArrowControlEmptyTemplate}"
                                                    Visibility="{Binding IsFlyoutButtonVisible, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource ResourceKey=boolToVisibilityConverter}}">
                        <dxnavi:TileBarItemArrowControl.Resources>
                            <Style x:Key="{dxdst:DefaultStyleThemeKey FullName=DevExpress.Xpf.Navigation.Internal.TileBarItemArrowControl}"
                                   TargetType="dxnavi:TileBarItemArrowControl">
                                <Setter Property="Height" Value="10" />
                                <Setter Property="Focusable" Value="False" />
                            </Style>
                        </dxnavi:TileBarItemArrowControl.Resources>
                    </dxnavi:TileBarItemArrowControl>
                </Grid>
            </dx:DXBorder>
            <dx:DXBorder x:Name="PART_Shadow"
                         Margin="{TemplateBinding SelectionPadding}"
                         Background="Black"
                         EnableDPICorrection="False"
                         IsHitTestVisible="False"
                         Opacity="0.16"
                         Visibility="Collapsed">
                <dx:DXBorder.RenderTransform>
                    <TranslateTransform x:Name="ShadowTransform" Y="{Binding ActualHeight, ElementName=Border}" />
                </dx:DXBorder.RenderTransform>
                <dx:DXBorder.OpacityMask>
                    <LinearGradientBrush EndPoint="0,1">
                        <GradientStop Offset="0.0" Color="#FF000000" />
                        <GradientStop Offset="0.5" Color="Transparent" />
                    </LinearGradientBrush>
                </dx:DXBorder.OpacityMask>
            </dx:DXBorder>
            <Border x:Name="selection"
                    BorderBrush="{TemplateBinding CalculatedBackground}"
                    BorderThickness="2"
                    IsHitTestVisible="False"
                    Opacity="0" />
            <VisualStateManager.VisualStateGroups>
                <VisualStateGroup x:Name="CommonStates">
                    <VisualState x:Name="MouseOver">
                        <Storyboard>
                            <DoubleAnimation Storyboard.TargetName="Border"
                                             Storyboard.TargetProperty="Opacity"
                                             To="0.50"
                                             Duration="0" />
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="Pressed" />
                    <VisualState x:Name="Disabled">
                        <Storyboard>
                            <DoubleAnimation Storyboard.TargetName="Border"
                                             Storyboard.TargetProperty="Opacity"
                                             To="0.35"
                                             Duration="0" />
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="Normal" />
                </VisualStateGroup>
                <VisualStateGroup x:Name="SelectionStates">
                    <VisualState x:Name="EmptySelectedState" />
                    <VisualState x:Name="Unselected" />
                    <VisualState x:Name="Selected">
                        <Storyboard>
                            <DoubleAnimation Storyboard.TargetName="selection"
                                             Storyboard.TargetProperty="Opacity"
                                             To="1"
                                             Duration="0" />
                        </Storyboard>
                    </VisualState>
                </VisualStateGroup>
                <VisualStateGroup x:Name="ShadowStates">
                    <VisualState x:Name="ShadowHidden" />
                    <VisualState x:Name="ShadowVisible">
                        <Storyboard>
                            <ObjectAnimationUsingKeyFrames dxcn:ValueSetter.Visibility="Visible"
                                                           Storyboard.TargetName="PART_Shadow"
                                                           Storyboard.TargetProperty="Visibility" />
                        </Storyboard>
                    </VisualState>
                </VisualStateGroup>
            </VisualStateManager.VisualStateGroups>
        </Grid>
    </ControlTemplate>

    <Style x:Key="TileBarItemStyleExtended"
           TargetType="{x:Type dxnav:TileBarItem}">
        <Setter Property="Command" Value="{Binding Command}" />
        <Setter Property="AllowGlyphTheming" Value="False" />
        <Setter Property="FlyoutContent" Value="{Binding}" />
        <Setter Property="FlyoutContentTemplate">
            <Setter.Value>
                <DataTemplate>
                    <Grid>
                        <dxnav:TileBar Margin="0,0,0,0"
                                       ctrls:CustomMenuTileFlyoutPosition.Enabled="True"
                                       ItemColorMode="Inverted"
                                       ItemsSource="{Binding Child.Children, Mode=OneWay}"
                                       Orientation="Horizontal"
                                       ShowItemShadow="False">
                            <dxnav:TileBar.ItemContainerStyle>
                                <Style TargetType="dxnav:TileBarItem">
                                    <Setter Property="AllowGlyphTheming" Value="False" />
                                    <Setter Property="Template">
                                        <Setter.Value>
                                            <ControlTemplate>
                                                <Grid Background="{DynamicResource CommonTextLightForeground}"
                                                      Height="{DynamicResource MenuTileHeight}"
                                                      Width="{DynamicResource MenuTileWidth}">
                                                    <Grid Margin="6">
                                                        <Grid.RowDefinitions>
                                                            <RowDefinition Height="*" />
                                                            <RowDefinition Height="Auto" />
                                                        </Grid.RowDefinitions>
                                                        <Image Source="{Binding Image}"
                                                               Height="24"
                                                               HorizontalAlignment="Left"
                                                               VerticalAlignment="Top" />
                                                        <TextBlock x:Name="ChildBarItemTB"
                                                                   Grid.Row="1"
                                                                   Foreground="{DynamicResource CommonDarkGrey}"
                                                                   Text="{Binding DisplayName}"
                                                                   VerticalAlignment="Bottom"
                                                                   FontSize="{DynamicResource MenuFontSize}" />
                                                    </Grid>
                                                </Grid>
                                            </ControlTemplate>
                                        </Setter.Value>
                                    </Setter>
                                    <Setter Property="Padding" Value="8,6,8,6" />
                                    <Setter Property="Command" Value="{Binding Command}" />
                                    <Setter Property="TileGlyph" Value="{Binding Image}" />
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding HasChildren}"
                                                     Value="true">
                                            <Setter Property="FlyoutContent" Value="{Binding Child}" />
                                            <Setter Property="FlyoutContentTemplateSelector" Value="{StaticResource FlyoutContentTemplateSelector}" />
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </dxnav:TileBar.ItemContainerStyle>
                        </dxnav:TileBar>
                        <TextBlock Margin="5,5,0,0"
                                   VerticalAlignment="Top"
                                   Focusable="False"
                                   Foreground="White"
                                   Text="{Binding Child.Info}"
                                   FontSize="{DynamicResource MenuFontSize}" />
                    </Grid>
                </DataTemplate>
            </Setter.Value>
        </Setter>
        <Setter Property="Padding" Value="8,6,8,6" />
        <Setter Property="ShowFlyoutButton" Value="True" />
        <Setter Property="TileGlyph" Value="{Binding Image}" />
        <Setter Property="Background" Value="{Binding BackColor}" />
    </Style>

    <Style x:Key="TileBarItemFirstLevelStyleExtended"
           BasedOn="{StaticResource TileBarItemStyleExtended}"
           TargetType="{x:Type dxnav:TileBarItem}">
        <Setter Property="ContentTemplate">
            <Setter.Value>
                <DataTemplate>
                    <TextBlock x:Name="ChildBarItemTB"
                               Foreground="{DynamicResource CommonTextLightForeground}"
                               Text="{Binding DisplayName}"
                               FontSize="{DynamicResource MenuFontSize}"/>
                </DataTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <DataTemplate x:Key="FlyoutCollectionTemplate">
        <ctrls:TileBarContentControl>
            <dxnav:TileBar ctrls:CustomMenuTileFlyoutPosition.Enabled="True"
                           ItemColorMode="Inverted"
                           ItemContainerStyle="{StaticResource TileBarItemStyleExtended}"
                           ItemsSource="{Binding Children}" />
            <TextBlock Margin="-175,5,0,0"
                       VerticalAlignment="Top"
                       Focusable="False"
                       Foreground="White"
                       Text="{Binding Info}" />
        </ctrls:TileBarContentControl>
    </DataTemplate>

    <Style TargetType="{x:Type dxnav:TileBar}">
        <Setter Property="ItemContainerStyle" Value="{StaticResource TileBarItemStyleExtended}" />
    </Style>

</ResourceDictionary>
