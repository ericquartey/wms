<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">

    <ControlTemplate x:Key="ValidationErrorTemplateStyle">
        <StackPanel Orientation="Horizontal">
            <Grid>
                <AdornedElementPlaceholder x:Name="adorner"
                                           MaxHeight="52"
                                           Margin="0,-30,0,0"
                                           HorizontalAlignment="Left"
                                           VerticalAlignment="Top" />
                <Border HorizontalAlignment="Stretch"
                        VerticalAlignment="Stretch"
                        BorderBrush="{DynamicResource ErrorMessageBackgroundColor}"
                        BorderThickness="1"
                        CornerRadius="0.1">
                    <Grid>
                        <Polygon x:Name="toolTipCorner"
                                 Margin="-1"
                                 HorizontalAlignment="Right"
                                 VerticalAlignment="Top"
                                 Fill="{DynamicResource ErrorMessageBackgroundColor}"
                                 Grid.ZIndex="2"
                                 IsHitTestVisible="True"
                                 Points="9,9 9,0 0,0" />
                        <Polyline Margin="-1"
                                  HorizontalAlignment="Right"
                                  VerticalAlignment="Top"
                                  Grid.ZIndex="3"
                                  IsHitTestVisible="True"
                                  Points="10,10 0,0"
                                  Stroke="White"
                                  StrokeEndLineCap="Round"
                                  StrokeStartLineCap="Round"
                                  StrokeThickness="1.5" />
                    </Grid>
                </Border>
            </Grid>
            <Border x:Name="errorBorder"
                    MaxWidth="250"
                    MaxHeight="25"
                    Margin="0,0,0,0"
                    Panel.ZIndex="10"
                    Background="{DynamicResource ErrorMessageBackgroundColor}"
                    CornerRadius="1.5"
                    IsHitTestVisible="False"
                    Opacity="0">
                <Border.Effect>
                    <DropShadowEffect BlurRadius="10"
                                      Direction="315"
                                      Opacity="0.8"
                                      ShadowDepth="5"
                                      Color="Black" />
                </Border.Effect>
                <TextBlock Margin="8,3,8,3"
                           Foreground="{DynamicResource ErrorMessageTextToolTipForegroundColor}"
                           Text="{Binding Path=AdornedElement.(Validation.Errors)/ErrorContent, ElementName=adorner}"
                           TextWrapping="Wrap" />
            </Border>
        </StackPanel>
        <ControlTemplate.Triggers>
            <Trigger Property="Visibility" Value="Visible">
                <Trigger.EnterActions>
                    <BeginStoryboard x:Name="fadeInStoryboard">
                        <Storyboard>
                            <DoubleAnimation Storyboard.TargetName="errorBorder"
                                             Storyboard.TargetProperty="Opacity"
                                             To="1"
                                             Duration="00:00:00.15" />
                            <ThicknessAnimation FillBehavior="HoldEnd"
                                                Storyboard.TargetName="errorBorder"
                                                Storyboard.TargetProperty="Margin"
                                                From="-20,-52,0,0"
                                                To="-8,-52,0,0"
                                                Duration="00:00:00.10">
                                <ThicknessAnimation.EasingFunction>
                                    <BackEase Amplitude="2"
                                              EasingMode="EaseIn"
                                              RenderOptions.EdgeMode="Aliased" />
                                </ThicknessAnimation.EasingFunction>
                            </ThicknessAnimation>
                        </Storyboard>
                    </BeginStoryboard>
                </Trigger.EnterActions>

                <Trigger.ExitActions>
                    <StopStoryboard BeginStoryboardName="fadeInStoryboard" />
                    <BeginStoryboard x:Name="fadeOutStoryBoard">
                        <Storyboard>
                            <DoubleAnimation Storyboard.TargetName="errorBorder"
                                             Storyboard.TargetProperty="Opacity"
                                             To="0"
                                             Duration="00:00:00.15" />
                        </Storyboard>
                    </BeginStoryboard>
                </Trigger.ExitActions>
            </Trigger>
        </ControlTemplate.Triggers>
    </ControlTemplate>

</ResourceDictionary>
