<UserControl
    x:Class="Ferretto.Common.Controls.WPF.TrayControl"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:conv="clr-namespace:Ferretto.Common.Controls.WPF.Converters"
    xmlns:ctrls="clr-namespace:Ferretto.Common.Controls.WPF"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    x:Name="Tray"
    HorizontalAlignment="Stretch"
    VerticalAlignment="Stretch"
    VerticalContentAlignment="Stretch"
    SnapsToDevicePixels="True"
    mc:Ignorable="d">

    <UserControl.Resources>
        <conv:InverseBooleanConverter x:Key="BNC" />
        <conv:BoolToVisibilityConverter x:Key="BTVC" />
        <conv:BoolToGridLengthConverter x:Key="BTGLC" />
        <conv:BoolToGridLengthConverter x:Key="BTGLIC" Invert="True" />
    </UserControl.Resources>

    <Grid
        Name="RootTrayGrid"
        HorizontalAlignment="Stretch"
        VerticalAlignment="Stretch"
        UseLayoutRounding="False">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" MinHeight="{Binding ShowRuler, Converter={StaticResource BTGLC}, ConverterParameter='25'}" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="1" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto" MinWidth="{Binding ShowRuler, Converter={StaticResource BTGLC}, ConverterParameter='25'}" />
            <ColumnDefinition Width="Auto" />
            <ColumnDefinition Width="1" />
            <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>

        <ctrls:RulerControl
            x:Name="HorizontalRulerControl"
            Grid.Column="1"
            Width="{Binding TrayWidth, ElementName=CanvasListBoxControl}"
            Height="{DynamicResource TrayRulerSize}"
            HorizontalAlignment="Left"
            VerticalAlignment="Stretch"
            VerticalContentAlignment="Stretch"
            DimensionHeight="{Binding DimensionHeight}"
            DimensionWidth="{Binding DimensionWidth}"
            FontFamily="{DynamicResource TrayFont}"
            FontSize="{Binding RulerFontSize}"
            Foreground="{Binding RulerForeground}"
            ForegroundText="{Binding RulerForeground}"
            HideAllMarkers="{Binding ShowRuler, Converter={StaticResource BNC}}"
            Orientation="Horizontal"
            OriginHorizontal="{Binding OriginHorizontal}"
            OriginVertical="{Binding OriginVertical}"
            RenderOptions.EdgeMode="Aliased"
            ShowInfo="{Binding ShowInfo}"
            ShowLittleMark="{Binding ShowLittleMark}"
            ShowMark="{Binding ShowMark}"
            ShowMiddleMark="{Binding ShowMiddleMark}"
            Step="{Binding RulerStep}"
            TrayHeight="{DynamicResource TrayRulerSize}"
            TrayWidth="{Binding TrayWidth, ElementName=CanvasListBoxControl}"
            UseLayoutRounding="False" />

        <ctrls:RulerControl
            x:Name="VerticalRulerControl"
            Grid.Row="1"
            Width="{DynamicResource TrayRulerSize}"
            Height="{Binding Height, ElementName=CanvasListBoxControl}"
            HorizontalAlignment="Stretch"
            VerticalAlignment="Top"
            HorizontalContentAlignment="Stretch"
            VerticalContentAlignment="Bottom"
            DimensionHeight="{Binding DimensionHeight}"
            DimensionWidth="{Binding DimensionWidth}"
            FontFamily="{DynamicResource TrayFont}"
            FontSize="{Binding RulerFontSize}"
            Foreground="{Binding RulerForeground}"
            ForegroundText="{Binding RulerForeground}"
            HideAllMarkers="{Binding ShowRuler, Converter={StaticResource BNC}}"
            Orientation="Vertical"
            OriginHorizontal="{Binding OriginHorizontal}"
            OriginVertical="{Binding OriginVertical}"
            RenderOptions.EdgeMode="Aliased"
            ShowInfo="{Binding ShowInfo}"
            ShowLittleMark="{Binding ShowLittleMark}"
            ShowMark="{Binding ShowMark}"
            ShowMiddleMark="{Binding ShowMiddleMark}"
            Step="{Binding RulerStep}"
            TrayHeight="{Binding TrayHeight, ElementName=CanvasListBoxControl}"
            TrayWidth="{DynamicResource TrayRulerSize}"
            UseLayoutRounding="False" />

        <ctrls:CanvasListBoxControl
            x:Name="CanvasListBoxControl"
            Grid.Row="1"
            Grid.Column="1"
            HorizontalAlignment="Left"
            VerticalAlignment="Top"
            ctrls:SelectorBehavior.ShouldSelectItemOnMouseUp="True"
            Compartments="{Binding Compartments}"
            DefaultCompartmentColor="{Binding DefaultCompartmentColor}"
            DimensionHeight="{Binding DimensionHeight}"
            DimensionWidth="{Binding DimensionWidth}"
            Foreground="{Binding RulerForeground}"
            GridLinesColor="{Binding GridLinesColor}"
            IsCompartmentSelectable="{Binding IsCompartmentSelectable}"
            IsEnabled="{Binding IsEnabled}"
            IsReadOnly="{Binding IsReadOnly}"
            ItemContainerStyle="{DynamicResource CanvasItemStyle}"
            OriginHorizontal="{Binding OriginHorizontal}"
            OriginVertical="{Binding OriginVertical}"
            RenderOptions.EdgeMode="Aliased"
            RulerSize="{DynamicResource TrayRulerSize}"
            ScrollViewer.HorizontalScrollBarVisibility="Disabled"
            ScrollViewer.VerticalScrollBarVisibility="Disabled"
            SelectedColorFilterFunc="{Binding SelectedColorFilterFunc}"
            SelectedCompartment="{Binding SelectedItem, Mode=TwoWay}"
            ShowBackground="{Binding ShowBackground}"
            ShowRuler="{Binding ShowRuler}"
            Step="{Binding RulerStep}"
            Style="{DynamicResource CanvasListBox}"
            UseLayoutRounding="False" />

        <ctrls:RulerControl
            x:Name="BorderBottomRulerControl"
            Grid.Row="2"
            Grid.Column="1"
            Width="{Binding Width, ElementName=CanvasListBoxControl}"
            Height="1"
            HorizontalAlignment="Right"
            VerticalAlignment="Top"
            DimensionHeight="{Binding DimensionHeight}"
            DimensionWidth="{Binding DimensionWidth}"
            Foreground="{Binding RulerForeground}"
            HideAllMarkers="True"
            Orientation="Horizontal"
            OriginHorizontal="{Binding OriginHorizontal}"
            OriginVertical="{Binding OriginVertical}"
            RenderOptions.EdgeMode="Aliased"
            TrayHeight="1"
            TrayWidth="{Binding TrayWidth, ElementName=CanvasListBoxControl}"
            UseLayoutRounding="False" />
        <ctrls:RulerControl
            x:Name="BorderRightRulerControl"
            Grid.Row="1"
            Grid.Column="2"
            Width="1"
            Height="{Binding Height, ElementName=CanvasListBoxControl}"
            HorizontalAlignment="Right"
            VerticalAlignment="bottom"
            DimensionHeight="{Binding DimensionHeight}"
            DimensionWidth="{Binding DimensionWidth}"
            Foreground="{Binding RulerForeground}"
            HideAllMarkers="True"
            Orientation="vertical"
            OriginHorizontal="{Binding OriginHorizontal}"
            OriginVertical="{Binding OriginVertical}"
            RenderOptions.EdgeMode="Aliased"
            TrayHeight="{Binding TrayHeight, ElementName=CanvasListBoxControl}"
            TrayWidth="1"
            UseLayoutRounding="False" />
    </Grid>
</UserControl>
