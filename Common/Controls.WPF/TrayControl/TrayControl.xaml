<UserControl
    x:Class="Ferretto.Common.Controls.WPF.TrayControl"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:conv="clr-namespace:Ferretto.Common.Controls.WPF.Converters"
    xmlns:ctrls="clr-namespace:Ferretto.Common.Controls.WPF"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    x:Name="Tray"
    HorizontalAlignment="Stretch"
    VerticalAlignment="Stretch"
    VerticalContentAlignment="Stretch"
    mc:Ignorable="d">

    <UserControl.Resources>
        <conv:InverseBooleanConverter x:Key="BNC" />
        <conv:BoolToVisibilityConverter x:Key="BTVC" />
        <conv:BoolToGridLengthConverter x:Key="BTGLC" />
        <conv:BoolToGridLengthConverter x:Key="BTGLIC" Invert="True" />
    </UserControl.Resources>

    <Grid
        Name="RootTrayGrid"
        HorizontalAlignment="Stretch"
        VerticalAlignment="Stretch"
        UseLayoutRounding="True">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" MinHeight="1" />
            <RowDefinition Height="{Binding ShowRuler, Converter={StaticResource BTGLC}, ConverterParameter='1'}" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto" MinWidth="1" />
            <ColumnDefinition Width="{Binding ShowRuler, Converter={StaticResource BTGLC}, ConverterParameter='1'}" />
            <ColumnDefinition Width="Auto" />
            <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>

        <Label
            x:Name="UnitMetric"
            Grid.ColumnSpan="2"
            Width="{DynamicResource TrayRulerSize}"
            Height="{DynamicResource TrayRulerSize}"
            Padding="1,0,0,0"
            HorizontalAlignment="Stretch"
            VerticalAlignment="Stretch"
            HorizontalContentAlignment="Center"
            VerticalContentAlignment="Center"
            Content="{Binding RulerInfo}"
            FontFamily="{DynamicResource TrayFont}"
            FontWeight="Bold"
            Foreground="{Binding RulerForeground}"
            Visibility="{Binding ShowRuler, Converter={StaticResource BTVC}}" />
        <ctrls:RulerControl
            x:Name="HorizontalRulerControl"
            Grid.Column="2"
            Grid.ColumnSpan="1"
            Width="{Binding TrayWidth, ElementName=CanvasListBoxControl}"
            Height="{DynamicResource TrayRulerSize}"
            VerticalAlignment="Stretch"
            VerticalContentAlignment="Stretch"
            DimensionHeight="{Binding DimensionHeight}"
            DimensionWidth="{Binding DimensionWidth}"
            FontFamily="{DynamicResource TrayFont}"
            FontSize="{Binding RulerFontSize}"
            Foreground="{Binding RulerForeground}"
            ForegroundText="{Binding RulerForeground}"
            HideAllMarkers="{Binding ShowRuler, Converter={StaticResource BNC}}"
            Orientation="Horizontal"
            OriginHorizontal="{Binding OriginHorizontal}"
            OriginVertical="{Binding OriginVertical}"
            ShowInfo="{Binding ShowInfo}"
            ShowLittleMark="{Binding ShowLittleMark}"
            ShowMark="{Binding ShowMark}"
            ShowMiddleMark="{Binding ShowMiddleMark}"
            Step="{Binding RulerStep}"
            TrayHeight="{DynamicResource TrayRulerSize}"
            TrayWidth="{Binding TrayWidth, ElementName=CanvasListBoxControl}"
            UseLayoutRounding="True" />

        <Grid
            Name="BorderBottomRulerControlGrid"
            Grid.Row="2"
            HorizontalAlignment="Stretch"
            VerticalAlignment="Stretch">
            <Grid.RowDefinitions>
                <RowDefinition Height="{Binding ShowRuler, Converter={StaticResource BTGLIC}, ConverterParameter=1}" MaxHeight="1" />
                <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>
            <ctrls:RulerControl
                x:Name="VerticalRulerControl"
                Grid.RowSpan="2"
                Grid.ColumnSpan="1"
                Width="{DynamicResource TrayRulerSize}"
                Height="{Binding TrayHeight, ElementName=CanvasListBoxControl}"
                HorizontalAlignment="Stretch"
                VerticalAlignment="Top"
                HorizontalContentAlignment="Stretch"
                VerticalContentAlignment="Top"
                DimensionHeight="{Binding DimensionHeight}"
                DimensionWidth="{Binding DimensionWidth}"
                FontFamily="{DynamicResource TrayFont}"
                FontSize="{Binding RulerFontSize}"
                Foreground="{Binding RulerForeground}"
                ForegroundText="{Binding RulerForeground}"
                HideAllMarkers="{Binding ShowRuler, Converter={StaticResource BNC}}"
                Orientation="Vertical"
                OriginHorizontal="{Binding OriginHorizontal}"
                OriginVertical="{Binding OriginVertical}"
                ShowInfo="{Binding ShowInfo}"
                ShowLittleMark="{Binding ShowLittleMark}"
                ShowMark="{Binding ShowMark}"
                ShowMiddleMark="{Binding ShowMiddleMark}"
                Step="{Binding RulerStep}"
                TrayHeight="{Binding TrayHeight, ElementName=CanvasListBoxControl}"
                TrayWidth="{DynamicResource TrayRulerSize}"
                UseLayoutRounding="True" />
        </Grid>
        <ctrls:CanvasListBoxControl
            x:Name="CanvasListBoxControl"
            Grid.Row="2"
            Grid.Column="2"
            HorizontalAlignment="Left"
            VerticalAlignment="Top"
            Compartments="{Binding Compartments}"
            DefaultCompartmentColor="{Binding DefaultCompartmentColor}"
            DimensionHeight="{Binding DimensionHeight}"
            DimensionWidth="{Binding DimensionWidth}"
            GridLinesColor="{Binding GridLinesColor}"
            IsCompartmentSelectable="{Binding IsCompartmentSelectable}"
            IsEnabled="{Binding IsEnabled}"
            IsReadOnly="{Binding IsReadOnly}"
            ItemContainerStyle="{DynamicResource CanvasItemStyle}"
            OriginHorizontal="{Binding OriginHorizontal}"
            OriginVertical="{Binding OriginVertical}"
            RulerSize="{DynamicResource TrayRulerSize}"
            ScrollViewer.HorizontalScrollBarVisibility="Disabled"
            ScrollViewer.VerticalScrollBarVisibility="Disabled"
            SelectedColorFilterFunc="{Binding SelectedColorFilterFunc}"
            SelectedCompartment="{Binding SelectedItem, Mode=TwoWay}"
            ShowBackground="{Binding ShowBackground}"
            ShowRuler="{Binding ShowRuler}"
            Step="{Binding RulerStep}"
            Style="{DynamicResource CanvasListBox}"
            UseLayoutRounding="False" />
        <ctrls:RulerControl
            x:Name="BorderBottomRulerControl"
            Grid.Row="3"
            Grid.Column="2"
            Width="{Binding TrayWidth, ElementName=CanvasListBoxControl}"
            Height="1"
            HorizontalAlignment="Right"
            VerticalAlignment="Top"
            DimensionHeight="{Binding DimensionHeight}"
            DimensionWidth="{Binding DimensionWidth}"
            Foreground="{Binding RulerForeground}"
            HideAllMarkers="True"
            Orientation="Horizontal"
            OriginHorizontal="{Binding OriginHorizontal}"
            OriginVertical="{Binding OriginVertical}"
            TrayHeight="1"
            TrayWidth="{Binding TrayWidth, ElementName=CanvasListBoxControl}"
            UseLayoutRounding="True" />
        <Grid
            Name="BorderRightRulerControlGrid"
            Grid.Row="1"
            Grid.RowSpan="2"
            Grid.Column="3"
            HorizontalAlignment="stretch"
            VerticalAlignment="stretch">
            <Grid.RowDefinitions>
                <RowDefinition Height="{Binding ShowRuler, Converter={StaticResource BTGLIC}, ConverterParameter=1}" MaxHeight="1" />
                <RowDefinition Height="auto" />
            </Grid.RowDefinitions>
            <ctrls:RulerControl
                x:Name="BorderRightRulerControl"
                Grid.RowSpan="2"
                Grid.ColumnSpan="1"
                Width="1"
                Height="{Binding TrayHeight, ElementName=CanvasListBoxControl}"
                HorizontalAlignment="left"
                VerticalAlignment="bottom"
                DimensionHeight="{Binding DimensionHeight}"
                DimensionWidth="{Binding DimensionWidth}"
                Foreground="{Binding RulerForeground}"
                HideAllMarkers="True"
                Orientation="vertical"
                OriginHorizontal="{Binding OriginHorizontal}"
                OriginVertical="{Binding OriginVertical}"
                TrayHeight="{Binding TrayHeight, ElementName=CanvasListBoxControl}"
                TrayWidth="1"
                UseLayoutRounding="True" />
        </Grid>
    </Grid>
</UserControl>
